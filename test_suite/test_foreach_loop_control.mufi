// Test break and continue in foreach loops

print "=== Testing FOREACH loops with break and continue ===";
print "";

print "Test 1: Basic break in foreach loop";
var vec1 = {1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0};
foreach (element in vec1) {
    if (element == 5.0) {
        print "Breaking at element = 5";
        break;
    }
    print element;
}
print "After foreach loop with break";
print "";

print "Test 2: Basic continue in foreach loop";
var vec2 = {1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0};
foreach (num in vec2) {
    // Check if even by comparing with 2, 4, 6, 8, 10
    if (num == 2.0 or num == 4.0 or num == 6.0 or num == 8.0 or num == 10.0) {
        continue;  // Skip even numbers
    }
    print num;  // Should only print odd numbers: 1, 3, 5, 7, 9
}
print "After foreach loop with continue";
print "";

print "Test 3: Nested foreach loops with break and continue";
var outer = {1.0, 2.0, 3.0};
var inner = {1.0, 2.0, 3.0, 4.0, 5.0};
foreach (x in outer) {
    print "Outer loop x = " + x;
    foreach (y in inner) {
        if (y == 2.0) {
            continue;  // Skip y = 2
        }
        if (y == 4.0) {
            break;  // Break inner loop at y = 4
        }
        print "  Inner loop y = " + y;
    }
}
print "After nested foreach loops";
print "";

print "Test 4: Complex break/continue logic";
var count = 0;
var vec3 = {1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0};
foreach (k in vec3) {
    // Skip multiples of 3
    if (k == 3.0 or k == 6.0 or k == 9.0 or k == 12.0 or k == 15.0 or k == 18.0) {
        continue;  // Skip multiples of 3
    }
    count = count + 1;
    if (count > 5) {
        break;  // Stop after processing 5 non-multiples of 3
    }
    print "Processed: " + k;
}
print "Total non-multiples of 3 processed: " + count;
print "";

print "Test 5: Early continue in foreach";
var numbers = {10.0, 20.0, 30.0, 40.0, 50.0};
foreach (n in numbers) {
    if (n < 30.0) {
        continue;
    }
    print "Number >= 30: " + n;
}
print "";

print "Test 6: Immediate break";
var vec4 = {100.0, 200.0, 300.0, 400.0};
foreach (val in vec4) {
    print "First value: " + val;
    break;  // Should only print first value
}
print "After immediate break";
print "";

print "Test 7: Continue with all elements skipped";
var vec5 = {2.0, 4.0, 6.0, 8.0};
var printed = false;
foreach (even in vec5) {
    // All are even, so skip all
    if (even == 2.0 or even == 4.0 or even == 6.0 or even == 8.0) {
        continue;  // Skip all even numbers (which is all of them)
    }
    printed = true;
    print "This should not print: " + even;
}
if (!printed) {
    print "All elements were skipped as expected";
}
print "";

print "Test 8: Break with condition on sum";
var vec6 = {5.0, 10.0, 15.0, 20.0, 25.0, 30.0};
var sum = 0.0;
foreach (v in vec6) {
    sum = sum + v;
    print "Added " + v + ", sum = " + sum;
    if (sum >= 30.0) {
        print "Sum reached 30, breaking";
        break;
    }
}
print "Final sum: " + sum;
print "";

print "Test 9: Continue based on index simulation";
var vec7 = {11.0, 22.0, 33.0, 44.0, 55.0};
var idx = 0;
foreach (value in vec7) {
    idx = idx + 1;
    if (idx == 2 or idx == 4) {
        continue;  // Skip 2nd and 4th elements
    }
    print "Element at position " + idx + ": " + value;
}
print "";

print "Test 10: Empty vector with foreach";
var empty = {};
foreach (e in empty) {
    print "This should not print!";
    break;  // This break should never execute
}
print "Empty vector handled correctly";
print "";

print "Test 11: Single element with break";
var single = {42.0};
foreach (s in single) {
    print "Single element: " + s;
    break;
}
print "Single element processed";
print "";

print "Test 12: Range iteration with break/continue";
foreach (r in 1..10) {
    if (r < 3) {
        continue;  // Skip values less than 3
    }
    if (r > 7) {
        break;  // Stop after 7
    }
    print "Range value: " + r;
}
print "";

print "Test 13: Inclusive range with continue";
foreach (r in 1..=10) {
    // Skip even numbers (2, 4, 6, 8, 10)
    if (r == 2 or r == 4 or r == 6 or r == 8 or r == 10) {
        continue;  // Skip even numbers
    }
    if (r > 7) {
        break;
    }
    print "Odd in range: " + r;
}
print "";

print "=== All FOREACH loop tests completed ===";
